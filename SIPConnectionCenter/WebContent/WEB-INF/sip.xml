<?xml version="1.0" encoding="UTF-8"?>
<sip-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns="http://java.sun.com/xml/ns/javaee" xmlns:sip="http://www.jcp.org/xml/ns/sipservlet/sip-app_1_1.xsd"
	xsi:schemaLocation="http://www.jcp.org/xml/ns/sipservlet http://www.jcp.org/xml/ns/sipservlet/sip-app_1_1.xsd"
	id="SipApp_ID" version="1.1">
	<app-name>com.sipcm.CallCenter</app-name>

	<servlet>
		<servlet-name>CallCenterServlet</servlet-name>
		<display-name>CallCenterServlet</display-name>
		<description>Call Center Servlet</description>
		<servlet-class>
			com.sipcm.sip.servlet.CallCenterServlet
        </servlet-class>
		<load-on-startup>1</load-on-startup>
	</servlet>

	<servlet>
		<servlet-name>RegistrarServlet</servlet-name>
		<display-name>RegistrarServlet</display-name>
		<description>Registrar Servlet</description>
		<servlet-class>
			com.sipcm.sip.servlet.RegistrarServlet
        </servlet-class>
		<load-on-startup>1</load-on-startup>
	</servlet>

	<servlet>
		<servlet-name>InviteServlet</servlet-name>
		<display-name>InviteServlet</display-name>
		<description>Invite Servlet</description>
		<servlet-class>
			com.sipcm.sip.servlet.InviteServlet
        </servlet-class>
		<load-on-startup>1</load-on-startup>
	</servlet>

	<servlet-selection>
		<servlet-mapping>
			<servlet-name>RegistrarServlet</servlet-name>
			<pattern>
				<equal>
					<var>request.method</var>
					<value>REGISTER</value>
				</equal>
			</pattern>
		</servlet-mapping>
		<servlet-mapping>
			<servlet-name>InviteServlet</servlet-name>
			<pattern>
				<equal>
					<var>request.method</var>
					<value>INVITE</value>
				</equal>
			</pattern>
		</servlet-mapping>
		<servlet-mapping>
			<servlet-name>CallCenterServlet</servlet-name>
			<pattern>
				<not>
					<or>
						<equal>
							<var>request.method</var>
							<value>REGISTER</value>
						</equal>
						<equal>
							<var>request.method</var>
							<value>INVITE</value>
						</equal>
					</or>
				</not>
			</pattern>
		</servlet-mapping>
	</servlet-selection>

	<listener>
		<listener-class>
			com.sipcm.sip.servlet.ErrorListener
		</listener-class>
	</listener>

	<!-- <security-constraint> <display-name>MyServlet Security Constraint</display-name> 
		<resource-collection> <resource-name>CallCenterResource</resource-name> <description>Securing 
		MyServlet</description> <servlet-name>CallCenterServlet</servlet-name> <sip-method>MESSAGE</sip-method> 
		<sip-method>INVITE</sip-method> </resource-collection> <proxy-authentication 
		/> <auth-constraint> <role-name>*</role-name> </auth-constraint> </security-constraint> 
		<security-constraint> <display-name>MyServlet Security Constraint</display-name> 
		<resource-collection> <resource-name>CallCenterResource</resource-name> <description>Securing 
		MyServlet</description> <servlet-name>CallCenterServlet</servlet-name> <sip-method>REGISTER</sip-method> 
		</resource-collection> <auth-constraint> <role-name>caller</role-name> </auth-constraint> 
		</security-constraint> -->

	<security-constraint>
		<display-name>REGISTER Method Security Constraint</display-name>
		<resource-collection>
			<resource-name>RigstrarServletResource</resource-name>
			<description>Require authenticated REGSITER requests</description>
			<servlet-name>RegistrarServlet</servlet-name>
		</resource-collection>
		<auth-constraint>
			<role-name>caller</role-name>
		</auth-constraint>
	</security-constraint>
	<login-config>
		<auth-method>DIGEST</auth-method>
		<realm-name>gaofamily.org</realm-name>
	</login-config>
</sip-app>