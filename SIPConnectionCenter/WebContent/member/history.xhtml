<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	template="/WEB-INF/templates/memberLayout.xhtml">
	<ui:define name="windowTitle">#{messages['member.call.log.title']}</ui:define>
	<ui:define name="memberContent">
		<p:growl id="growl" showDetail="true" />
		<f:view contentType="text/html">
			<h:form id="searchForm">
				<p:panel header="#{messages['member.call.log.search.condition']}">
					<h:panelGrid columns="4">
						<f:event listener="#{callLogBean.validateStatus}"
							type="postValidate" />
						<h:outputLabel for="startDate"
							value="#{messages['member.call.log.start.date']}" />
						<p:calendar id="startDate" value="#{callLogBean.startDate}"
							showOn="button" required="true"
							requiredMessage="#{messages['member.call.log.start.date.required']}"
							timeZone="#{localeTimeZoneHolderBean.timeZone}"
							locale="#{localeTimeZoneHolderBean.locale}"
							pattern="#{messages['global.date.pattern']}" />
						<h:outputLabel for="endDate"
							value="#{messages['member.call.log.end.date']}" />
						<p:calendar id="endDate" value="#{callLogBean.endDate}"
							showOn="button" timeZone="#{localeTimeZoneHolderBean.timeZone}"
							locale="#{localeTimeZoneHolderBean.locale}"
							pattern="#{messages['global.date.pattern']}" />
						<h:outputLabel for="callStatus"
							value="#{messages['member.call.log.status']}" />
						<h:panelGroup id="callStatus">
							<h:selectBooleanCheckbox id="includeConnected"
								value="#{callLogBean.includeConnected}" />
							<h:outputText
								value="#{messages['member.call.log.status.connected']}" />
							<h:selectBooleanCheckbox id="includeFailed"
								value="#{callLogBean.includeFailed}" />
							<h:outputText
								value="#{messages['member.call.log.status.failed']}" />
							<h:selectBooleanCheckbox id="includeCancelled"
								value="#{callLogBean.includeCancelled}" />
							<h:outputText
								value="#{messages['member.call.log.status.cancelled']}" />
						</h:panelGroup>
						<h:outputLabel for="callType"
							value="#{messages['member.call.log.type']}" />
						<h:selectOneMenu id="callType" value="#{callLogBean.callType}">
							<f:selectItems value="#{callLogBean.callTypes}" />
						</h:selectOneMenu>
					</h:panelGrid>
					<f:facet name="footer">
						<p:commandButton ajax="true" id="submit"
							value="#{messages['member.call.log.search']}"
							actionListener="#{callLogBean.updateFilter}"
							update="callLogList growl" />
					</f:facet>
				</p:panel>
			</h:form>
			<h:form id="callLogList">
				<p:dataTable id="callLogTbl" var="callLog"
					value="#{callLogBean.lazyModel}" paginator="true" rows="10"
					lazy="true"
					paginatorTemplate="{FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
					emptyMessage="#{messages['member.calllog.empty']}">
					<f:facet name="header">
						<h:outputText value="#{messages['member.call.log.list']}" />
						<h:commandLink>
							<h:graphicImage library="images" name="pdf.png" />
							<p:dataExporter type="pdf" target="callLogTbl"
								fileName="call-log" />
						</h:commandLink>
						<h:commandLink>
							<h:graphicImage library="images" name="excel.png" />
							<p:dataExporter type="xls" target="callLogTbl"
								fileName="call-log" />
						</h:commandLink>
					</f:facet>
					<p:column sortBy="#{callLog.startTime}">
						<f:facet name="header">
							<h:outputText value="#{messages['member.calllog.start.date']}" />
						</f:facet>
						<h:outputText value="#{callLog.startTime}">
							<f:convertDateTime
								pattern="#{messages['global.datetime.pattern']}"
								timeZone="#{localeTimeZoneHolderBean.timeZone}" />
						</h:outputText>
					</p:column>
					<p:column sortBy="#{callLog.duration}">
						<f:facet name="header">
							<h:outputText value="#{messages['member.calllog.dure']}" />
						</f:facet>
						<h:outputText value="#{callLog.duration}"
							converter="#{durationConverter}" />
					</p:column>
					<p:column sortBy="#{callLog.voipAccount.name}"
						filterBy="#{callLog.voipAccount.name}">
						<f:facet name="header">
							<h:outputText value="#{messages['member.calllog.viop.account']}" />
						</f:facet>
						<h:outputText
							value="#{callLog.voipAccount == null ? '' : callLog.voipAccount.name}" />
					</p:column>
					<p:column sortBy="#{callLog.status}">
						<f:facet name="header">
							<h:outputText value="#{messages['member.calllog.status']}" />
						</f:facet>
						<h:outputText value="#{callLog.status}" />
					</p:column>
					<p:column sortBy="#{callLog.type}">
						<f:facet name="header">
							<h:outputText value="#{messages['member.calllog.type']}" />
						</f:facet>
						<h:outputText value="#{callLog.type}" />
					</p:column>
					<p:column sortBy="#{callLog.partner}" filterBy="#{callLog.partner}">
						<f:facet name="header">
							<h:outputText value="#{messages['member.calllog.number']}" />
						</f:facet>
						<h:outputText value="#{callLog.partner}" />
					</p:column>
				</p:dataTable>
			</h:form>
		</f:view>
	</ui:define>
</ui:composition>
